const axios = require("axios"); const API_BASE_URL = "http://localhost:5001/api"; const tempAdmin = { email: "admin@healthcare.com", password: "admin123" }; async function testAdminPages() { console.log("🧪 测试管理员页面API...
"); try { console.log("1. 管理员登录..."); const loginResponse = await axios.post(`${API_BASE_URL}/auth/login`, tempAdmin); const token = loginResponse.data.token; console.log("✅ 登录成功，获取token"); const headers = { Authorization: `Bearer ${token}` }; console.log("
2. 测试用户管理API..."); try { const usersResponse = await axios.get(`${API_BASE_URL}/admin/users`, { headers }); console.log("✅ 用户管理API正常"); console.log(`   用户数量: ${usersResponse.data.users.length}`); if (usersResponse.data.users.length > 0) { const firstUser = usersResponse.data.users[0]; console.log(`   第一个用户: ${firstUser.name} (${firstUser.email}) - ${firstUser.role}`); console.log(`   用户ID字段: _id = ${firstUser._id}, id = ${firstUser.id || "undefined"}`); } } catch (error) { console.log("❌ 用户管理API失败:", error.response?.data?.message); } console.log("
🎉 管理员页面API测试完成！"); } catch (error) { console.error("❌ 测试失败:", error.response?.data || error.message); } } testAdminPages();
